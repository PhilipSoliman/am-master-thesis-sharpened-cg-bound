\chapter{Results}\label{ch:results}
In this chapter we present and discuss two experiments with the sharpened CG iteration bounds from \cref{alg:multi_cluster_cg_bound,alg:multi_tail_cluster_cg_bound} applied to the approximate eigenspectra calculated as a by-product of the PCG method applied to the discretized elliptic problem \cref{prob:elliptic_problem_discretized}. The first experiment in \cref{sec:sharpness_of_bounds} tests the absolute sharpness of the new bounds as compared to the actual number of CG iterations required for convergence given a residual error tolerance $\epsilon_r$. Where the first experiment presumes a full spectrum to be available at the time of calculating the new bounds, this is usually not the case in practice. Therefore, the second experiment in \cref{sec:early_estimation_of_iterations} investigates the capability of the new bounds to predict the number of CG iterations required for convergence, but based on approximate spectra obtained in the first $N_{iter}$ iterations. Each experiment is conducted on the same set of meshes $\mathcal{Q}$, using the preconditioners from $\mathcal{M}^{-1}$ and for at least the two coefficient functions $\mathcal{C}_{\text{3layer, vert}}$ and $\mathcal{C}_{\text{edge slabs, around vertices}}$ as described in \cref{ch:implementation}. 

\section{Sharpness of bounds}\label{sec:sharpness_of_bounds}
Here we run the PCG method from \cref{alg:pcg_left} until we achieve convergence in the sense of \cref{th:residual_convergence_criterion} with $\epsilon_r=10^{-8}$. Every iteration we store the CG coefficients $\alpha,\beta$ such that at convergence we can construct the Lanczos matrix $T_m$ using \cref{eq:cg_lanczos_eta,eq:cg_lanczos_delta,eq:lanczos_tridiagonal}. Then, we calculate all eigenvalues of $T_m$, also known as \textit{Ritz} values. The eigenvalue spectrum $\sigma(T_m)$ at convergence of the PCG method is a \textit{good} approximation of the spectrum $\sigma(M^{-1}A)$. Therefore, we can use as input $\sigma(T_m)$ for the multi-cluster and multi-tail-cluster CG iteration bounds from \cref{alg:multi_cluster_cg_bound,alg:multi_tail_cluster_cg_bound} and study how well the bounds match the actual number of CG iterations $m$ required for convergence. 

Before we present the iteration bounds, we first show in \cref{fig:partitioning_eigenspectrum,fig:partitioning_eigenspectrum_tails} the output of $\operatorname{PartitionEigenspectrum}$ and $\operatorname{PartitionEigenspectrumTails}$ from \cref{alg:partition_eigenspectrum,alg:partition_eigenspectrum_tails} corresponding to the CG iteration bounds from \cref{alg:multi_cluster_cg_bound,alg:multi_tail_cluster_cg_bound} respectively. We observe that where the multi-cluster partitioning algorithm \cref{alg:partition_eigenspectrum} consistently splits the eigenspectra $\sigma(M^{-1}A) \ \forall M^{-1} \in\mathcal{M}^{-1}$ into two clusters, the multi-tail-cluster partitioning algorithm \cref{alg:partition_eigenspectrum_tails} partitions the eigenspectrum into either one or two tail clusters and/or one regular cluster, depending on the coarse mesh size $H$. 

For instance, consider the partitioning of the eigenspectrum $\sigma(M_{\text{2-OAS-AMS}}^{-1}A)$ for the mesh $Q_{1/4}$ and coefficient function $\mathcal{C}_{\text{3layer, vert}}$ among \cref{fig:partitioning_eigenspectrum,fig:partitioning_eigenspectrum_tails}. $\operatorname{PartitionEigenspectrum}$ does not split $\sigma(M_{\text{2-OAS-AMS}}^{-1}A)$ and simply returns the extremal eigenvalues. In contrast, $\operatorname{PartitionEigenspectrumTails}$ finds two tail clusters, resulting in an output that consists exclusively of tail eigenvalues. In regard to the CG iteration bounds, this means that $m_{N_{\text{cluster}}} = m_1$ and $m_{N_{\text{tail-cluster}}} = m$. That is the multi-cluster bound is equal to the classical bound, while the multi-tail-cluster bound is equal to the actual number of CG iterations $m$ required for convergence.
\begin{figure}[H]
    \centering
    \includegraphics{spectra_multi_cluster.pdf}
    \caption{Partition of the eigenspectrum $\sigma(T_m)\approx\sigma(M^{-1}A)$ for $M^{-1}\in\mathcal{M}$ into clusters using the multi-cluster partitioning algorithm \cref{alg:partition_eigenspectrum}. The left and right columns correspond coarse meshes $Q_{1/4}$ and $Q_{1/64}$ and the first and second row correspond to the coefficient functions $\mathcal{C}_{\text{3layer, vert}}$ and $\mathcal{C}_{\text{edge slabs, around vertices}}$ respectively. Every spectrum's condition number is plotted to the right of it as well as the number of PCG iterations $m$ required for convergence. Eigenvalues are shown as crosses and clusters are indicated using square brackets.}
    \label{fig:partitioning_eigenspectrum}
\end{figure}

Another interesting observation can be made when comparing the output of $\operatorname{PartitionEigenspectrumTails}$ given of the eigenspectrum $\sigma(M_{\text{2-OAS-RGDSW}}^{-1}A)$ for coefficient function $\mathcal{C}_{\text{3layer, vert}}$ among meshes $Q_{1/4}$ and $Q_{1/64}$ in \cref{fig:partitioning_eigenspectrum_tails}. For the mesh $Q_{1/4}$, $\operatorname{PartitionEigenspectrumTails}$ finds two tail clusters and one regular cluster. For the finest mesh $Q_{1/64}$, however, it finds only one tail cluster and one regular cluster. This indicates that second tail cluster and regular cluster are merged into one regular cluster as the mesh size $H$ decreases. The term `merged' is used here to mean that for $Q_{1/64}$ neither one of the splitting conditions in \cref{alg:partition_eigenspectrum_tails} is satisfied, i.e., the second cluster is not sufficiently separated from the third cluster from \cref{eq:threshold_inequality_explicit_expansion}, nor do the number of eigenvalues in the cluster satisfy the sparsity condition from \cref{eq:tail_cluster_bound_sparsity_condition}. 
\begin{figure}[H]
    \centering
    \includegraphics{spectra_tail_cluster.pdf}
    \caption{Partition of the eigenspectrum $\sigma(T_m)\approx\sigma(M^{-1}A)$ for $M^{-1}\in\mathcal{M}$ into tail clusters using the tail-cluster partitioning algorithm \cref{alg:partition_eigenspectrum_tails}. The left and right columns correspond coarse meshes $Q_{1/4}$ and $Q_{1/64}$ and the first and second row correspond to the coefficient functions $\mathcal{C}_{\text{3layer, vert}}$ and $\mathcal{C}_{\text{edge slabs, around vertices}}$ respectively. Every spectrum's condition number is plotted to the right of it as well as the number of PCG iterations $m$ required for convergence. Eigenvalues are shown either as crosses or as circles, depending on whether they form a regular or tail cluster, respectively. Additionally, starting indices of tail clusters, $I_t$, are indicated using vertical bars `|'}
    \label{fig:partitioning_eigenspectrum_tails}
\end{figure}

In \cref{fig:cg_bounds_gdsw,fig:cg_bounds_rgdsw,fig:cg_bounds_ams} we present the CG iteration bounds $m_{N_{\text{cluster}}}, m_{N_{\text{tail-cluster}}}$ produced by $\operatorname{MultiClusterCGIterationBound}$ and $\operatorname{MultiTailClusterCGIterationBound}$ from \cref{alg:multi_cluster_cg_bound,alg:multi_tail_cluster_cg_bound}, respectively. As mentioned in \cref{sec:cg_iteration_bound_algorithm}, the output $\operatorname{PartitionEigenspectrum}$ and $\operatorname{PartitionEigenspectrumTails}$ is specifically designed such that bounds $m_{N_{\text{cluster}}}, m_{N_{\text{tail-cluster}}} < m_1$. That is, no special effort was made to make the bounds sharp with respect to the actual number of CG iterations $m$ required for convergence. Fortunately, on all meshes, for all coefficient functions and for all meshes both bounds are either of the same order $m_{N_{\text{cluster}}}, m_{N_{\text{tail-cluster}}} = \mathcal{O}(m)$ or one order higher $m_{N_{\text{cluster}}}, m_{N_{\text{tail-cluster}}} = \mathcal{O}(10m)$.
\begin{figure}[H]
    \centering
    \includegraphics{absolute_performance_2-OAS-GDSW.pdf}
    \caption{Plot of the number of CG iterations $m$ (solid, red line with small circle markers)required to achieve convergence of the solution to \cref{prob:elliptic_problem_discretized} in the sense of criterion \cref{eq:residual_convergence_criterion_r} with $\epsilon_r=10^{-8}$. The left and right columns corresponds to the $\mathcal{C}_{\text{3layer, vert}}$ and $\mathcal{C}_{\text{edge slabs, around vertices}}$ coefficient functions. Also shown are the corresponding classical $m_1$ (dashed, light-gray line with cross markers), multi-cluster $m_{N_{\text{cluster}}}$ (dotted, dark-blue line with triangle markers), and multi-tail-cluster $m_{N_{\text{tail-cluster}}}$ (dash-dotted, gold line with big circle markers) bounds for the CG method applied to the eigenspectra obtained from the Lanczos matrix convergence (Ritz values).}
    \label{fig:cg_bounds_gdsw}
\end{figure}
\begin{figure}[H]
    \centering\includegraphics{absolute_performance_2-OAS-RGDSW.pdf}
    \caption{Similar to \cref{fig:cg_bounds_gdsw}, but now for RGDSW coarse space.}
    \label{fig:cg_bounds_rgdsw}
\end{figure}
\begin{figure}[H]
    \centering\includegraphics{absolute_performance_2-OAS-AMS.pdf}
    \caption{Similar to \cref{fig:cg_bounds_gdsw}, but now for AMS coarse space.}
    \label{fig:cg_bounds_ams}
\end{figure}
Additionally, it appears $m_{N_{\text{tail-cluster}}} \lesssim m_{N_{\text{cluster}}}$. Even though this was not a design goal of the multi-tail-cluster CG iteration bound, it is a desirable property. The reason for the sharper multi-tail-cluster bound stems from the more rigorous partitioning done by $\operatorname{PartitionEigenspectrumTails}$ compared to $\operatorname{PartitionEigenspectrum}$, as shown in \cref{fig:partitioning_eigenspectrum_tails} and the related discussion above.

\section{Early estimation of CG iteration bounds}\label{sec:early_estimation_of_iterations}
\todo{Add plot of bounds convergence on some high-contrast coefficient function for a robust coarse space (AMS) together with its eigenspectrum. Explain the migration of Ritz values and the fact that we need to wait for temporary convergence of clusters to reliably calculate and update the new bounds.}
\begin{figure}[H]
    \centering
    \includegraphics{bound_and_spectrum_vs_iterations_2-OAS-AMS.pdf}
    \caption{}
    \label{fig:bound_and_spectrum_vs_iterations_2-OAS-AMS}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics{bound_and_spectrum_vs_iterations_2-OAS-RGDSW.pdf}
    \caption{}
    \label{fig:bound_and_spectrum_vs_iterations_2-OAS-RGDSW}
\end{figure}
\todo{Show the convergence of the RGDSW bound. Ritz value migration happens more slowly so we need more iterations before we can update the bounds.}
\todo{Explain setup of tables}
\input{../tables/cg_iteration_bound_coef=const.tex}
\input{../tables/cg_iteration_bound_coef=3lvert.tex}
\input{../tables/cg_iteration_bound_coef=slabs_around_vertices.tex}
\todo{Discuss the tables: how many iterations are needed to get a good estimate of the bounds? How do the bounds compare to the classical bound? How do the bounds compare to each other?}